--
- name: Provision the OpenConext VM for EngineBlock
  hosts: engine
  remote_user: "{{ remote_user }}"

  vars:


  tasks:
  - name: Make sure a database exists
    mysql_db:
      state:          present
      name:           {{ engine_db_name }}
      login_host:     {{ engine_db_host }}
      login_port:     {{ engine_db_port}}
      login_user:     {{ admin_db_user }}
      login_password: {{ admin_db_password}}
      encoding:       utf8
      collation:      utf8_unicode_ci

  - name: Make sure a user exists
    mysql_user:
      state:          present
      name:           {{ engine_db_user }}
      password:       {{ engine_db_password }}
      priv:           {{ engine_db_name }}.*:ALL
      login_host:     {{ engine_db_host }}
      login_port:     {{ engine_db_port}}
      login_user:     {{ admin_db_user }}
      login_password: {{ admin_db_password}}

  - name: Make sure LDAP database exists

  - name: INSTALL EngineBlock using Ansible
    include: {{ }}

  - name: Set all configuration values for EngineBlock
    ini_file:
      dest:     /etc/openconext/engineblock.ini
      section:  demo
      option:   password
      value:    {{ engine_db_password }}

  - name: SETUP EngineBlock using Ansible